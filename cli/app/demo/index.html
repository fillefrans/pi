<!doctype html>
<html>
<head>
  <script>
    var 
      π  = {
        DEBUG : true,
        __sessionstart : (new Date()).getTime()
      };
  </script>

  <title>π demo</title>

  <meta charset="utf-8">
  <meta name="viewport"  content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">  
  
  <!-- the core CSS from pi -->
  <link rel="stylesheet" href="../../assets/css/pi.core.css">

  <!-- the app CSS -->
  <link href='http://fonts.googleapis.com/css?family=Ropa+Sans:400,400italic|Passion+One' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="assets/css/pi.app.css">
  <link rel="shortcut icon" href="../../assets/ico/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/icon-114.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72"   href="assets/ico/icon-72.png">
  <link rel="apple-touch-icon-precomposed"                 href="assets/ico/icon-57.png">
</head>
 
<body class="pi">



  <!-- This is the demo's div -->


  <div id="demo" class="pcl" data-name="pcl.table.xfilter">

    <table id="xfilter_table">
      <thead id="xfilter_table_head">xfilter</thead>
      <tbody id="xfilter_table_body">
      </tbody>
    </table>

    <script>

      var 

        xtable  = document.getElementById("xfilter_table"),
        xhead   = document.getElementById("xfilter_table_head"),
        xbody   = document.getElementById("xfilter_table_body"),

        xfilter = {

          eventsource : null,
          starttime   : null,
          element     : null,
          __data      : [],

          __onerror : function (err) {
            pi.log("Error in xfilter: " + JSON.stringify(err), err);
          },

          __init : function() {

          },

          onData : function (message) {
            var
              data = JSON.parse(message.data),
              self = pi.maverick.xfilter;

            pi.log("xfilter.onData: " + message.data);

          },

          run : function() {
            // pi.log("starting xfilter listener...");
            this.starttime    = new Date().getTime();
            this.element      = document.getElementById("xfilter");
            this.eventsource  = pi.listen("pi.app.demo.crossfilter.1", this.onData, this.__onerror);
            this.eventsource.addEventListener("data", this.onData, false);
            // pi.log("done.", this.eventsource);
            // pi.log("onmessage:", this.eventsource.onmessage);
          }
        };


        window.addEventListener("pi.session.start", function() {
          pi.maverick.xfilter = xfilter;
          pi.maverick.xfilter.run();
        }, false);


    </script>

  </div>







  <!-- End of demo's div -->







  <div id="numberstation" class="pcl" data-name="pcl.debug.numberstation">
    <script>

      var 

        numberstation = document.getElementById("numberstation"),
        randomWalk = {

          eventsource : null,
          starttime   : null,
          element     : null,

          __onerror : function (err) {
            pi.log("Error in randomWalk: ", err);
          },


          onRandomWalk : function (message) {
            var
              randomNumber  = JSON.parse(message.data),
              self          = pi.maverick.randomWalk;

            if(self.element) {
              self.element.innerHTML = randomNumber;
            }
          },

          run : function() {
            // pi.log("starting randomWalk listener...");
            this.starttime    = new Date().getTime();
            this.element      = document.getElementById("randomwalk");
            this.eventsource  = pi.listen("pi.service.numberstation.randomwalk", this.onRandomWalk, this.__onerror);
            this.eventsource.addEventListener("data", this.onRandomWalk, false);
            // pi.log("done.", this.eventsource);
            // pi.log("onmessage:", this.eventsource.onmessage);
          }
        };


        window.addEventListener("pi.session.start", function() {
          pi.maverick.randomWalk = randomWalk;
          // pi.maverick.randomWalk.run();
        }, false);


    </script>
    <div id="randomwalk"></div>
  </div>


  <script src="assets/js/lib/gsap/TimelineMax.min.js"></script>
  <script src="assets/js/lib/gsap/TweenMax.min.js"></script>
  <script src="assets/js/lib/raphael.min.js"></script>
  <script src="../../assets/js/lib/crossfilter.js"></script>


  <!--  bootstrap pi -->
  <script src="../../assets/js/pi.core.js"></script>


  <!--  bootstrap pcl 
    <script src="../../assets/js/pi.pcl.js"></script>
  -->

</body>
</html>